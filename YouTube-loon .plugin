#!name= ğ˜ğ¨ğ®ğ“ğ®ğ›ğğŸš«/â¿»/â–¶ï¸É¢Ê€ç‰ˆ  
#!desc=Youtube & YouTube Music å»å¹¿å‘Š/ç”»ä¸­ç”»/åå°æ’­æ”¾ï¼Œæ”¯æŒå‚æ•°æ§åˆ¶ç¿»è¯‘åŠç•Œé¢å…ƒç´   
#!author=deezertidal  
#!icon=https://upload.wikimedia.org/wikipedia/commons/4/42/YouTube_icon_%282013-2017%29.png  
#!homepage=  
#!tag=YouTubeå»å¹¿å‘Š  
#!system=iOS  
#!system_version=15.0  
#!loon_version=3.2.1(372)  

#!arguments=blockUpload:true,blockImmersive:true,captionLang:zh-Hans,lyricLang:zh-Hans,engine:auto,debug:false  
#!arguments-desc=- å‚æ•°è¯´æ˜ï¼š\nblockUpload / blockImmersive ä¸ºæŒ‰é’®å±è”½é€‰é¡¹ï¼›\ncaptionLang / lyricLang ä¸ºç¿»è¯‘è¯­è¨€ï¼ˆè¯­è¨€ä»£ç ï¼‰ï¼›\nengine å¯é€‰ jsc/webview/autoï¼›\ndebug ä¸ºè°ƒè¯•æ—¥å¿—è¾“å‡º  

[Argument]
blockUpload = switch, true, tag=blockUpload, desc=æ˜¯å¦å±è”½ä¸Šä¼ æŒ‰é’®
blockImmersive = switch, true, tag=blockImmersive, desc=æ˜¯å¦å±è”½é€‰æ®µæŒ‰é’®
captionLang = input, zh-Hans, tag=captionLang, desc=è®¾ç½®å­—å¹•ç¿»è¯‘è¯­è¨€ï¼ˆè¯­è¨€ä»£ç ï¼‰
lyricLang = input, zh-Hans, tag=lyricLang, desc=è®¾ç½®æ­Œè¯ç¿»è¯‘è¯­è¨€ï¼ˆè¯­è¨€ä»£ç ï¼‰
engine = select, auto, jsc, webview, tag=engine, desc=è„šæœ¬æ‰§è¡Œå¼•æ“
debug = switch, false, tag=debug, desc=æ˜¯å¦å¯ç”¨è°ƒè¯•æ¨¡å¼

[Rule]
# å±è”½ UDP åè®®ä¸‹çš„ YouTube å¹¿å‘Š/ç»Ÿè®¡
AND,((DOMAIN-SUFFIX,googlevideo.com), (PROTOCOL,UDP)),REJECT
AND,((DOMAIN-SUFFIX,youtubei.googleapis.com), (PROTOCOL,UDP)),REJECT

[URL Rewrite]
# æ‹¦æˆªå¹¿å‘Šç›¸å…³çš„ initplayback è¯·æ±‚è¿”å›ç©ºç™½å›¾ç‰‡
^https?:\/\/[\w-]+\.googlevideo\.com\/initplayback.+&oad _ REJECT-IMG

[mock-response-body]
# è¿”å›ç©ºå†…å®¹ï¼ˆç”¨äºè¿›ä¸€æ­¥æ‹¦æˆªï¼‰
^https?:\/\/[\w-]+\.googlevideo\.com\/initplayback.+&oad mock-response-body data-type=text status-code=502

[Script]
# ä¸»å¤„ç†è„šæœ¬ï¼šæ‹¦æˆªå¹¶ä¿®æ”¹ YouTube æ¥å£å“åº”ï¼Œæ³¨å…¥å‚æ•°
http-response ^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/(browse|next|player|search|reel\/reel_watch_sequence|guide|account\/get_setting|get_watch) script-path=https://raw.githubusercontent.com/guren777/Shadowrocket/refs/heads/main/youtube.response.js, requires-body=true, binary-body-mode=true, timeout=10, engine={engine}, tag=YouTube_Response_Modification, argument={"lyricLang":"{lyricLang}","captionLang":"{captionLang}","blockUpload":{blockUpload},"blockImmersive":{blockImmersive},"debug":{debug}}

[MITM]
# å¯ç”¨ä¸­é—´äººä»£ç†åŠŸèƒ½ï¼Œç¡®ä¿è„šæœ¬èƒ½æ‹¦æˆªç›®æ ‡æ¥å£
hostname = %APPEND% *.googlevideo.com, youtubei.googleapis.com